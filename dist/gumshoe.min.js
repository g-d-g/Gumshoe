String.prototype.trim||!function(){var e=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;String.prototype.trim=function(){return this.replace(e,"")}}(),Array.prototype.reduce||(Array.prototype.reduce=function(e){"use strict";if(null==this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof e)throw new TypeError(e+" is not a function");var t,n=Object(this),r=n.length>>>0,s=0;if(2==arguments.length)t=arguments[1];else{for(;r>s&&!s in n;)s++;if(s>=r)throw new TypeError("Reduce of empty array with no initial value");t=n[s++]}for(;r>s;s++)s in n&&(t=e(t,n[s],s,n));return t}),function(e){"performance"in e||(e.performance={});var t=e.performance;e.performance.now=t.now||t.mozNow||t.msNow||t.oNow||t.webkitNow||Date.now||function(){return(new Date).getTime()}}(window),function(){"use strict";var e={};e.parse=function(e){return"string"!=typeof e?{}:(e=e.trim().replace(/^(\?|#)/,""),e?e.trim().split("&").reduce(function(e,t){var n=t.replace(/\+/g," ").split("="),r=n[0],s=n[1];return r=decodeURIComponent(r),s=void 0===s?null:decodeURIComponent(s),e.hasOwnProperty(r)?Array.isArray(e[r])?e[r].push(s):e[r]=[e[r],s]:e[r]=s,e},{}):{})},e.stringify=function(e){return e?Object.keys(e).map(function(t){var n=e[t];return Array.isArray(n)?n.map(function(e){return encodeURIComponent(t)+"="+encodeURIComponent(e)}).join("&"):encodeURIComponent(t)+"="+encodeURIComponent(n)}).join("&"):""},"function"==typeof define&&define.amd?define(function(){return e}):"undefined"!=typeof module&&module.exports?module.exports=e:window.queryString=e}(),!function(e,t,n){"undefined"!=typeof module&&module.exports?module.exports=n():"function"==typeof define&&define.amd?define(n):t[e]=n()}("reqwest",this,function(){function succeed(e){var t=protocolRe.exec(e.url);return t=t&&t[1]||window.location.protocol,httpsRe.test(t)?twoHundo.test(e.request.status):!!e.request.response}function handleReadyState(e,t,n){return function(){return e._aborted?n(e.request):e._timedOut?n(e.request,"Request is aborted: timeout"):void(e.request&&4==e.request[readyState]&&(e.request.onreadystatechange=noop,succeed(e)?t(e.request):n(e.request)))}}function setHeaders(e,t){var n,r=t.headers||{};r.Accept=r.Accept||defaultHeaders.accept[t.type]||defaultHeaders.accept["*"];var s="function"==typeof FormData&&t.data instanceof FormData;t.crossOrigin||r[requestedWith]||(r[requestedWith]=defaultHeaders.requestedWith),r[contentType]||s||(r[contentType]=t.contentType||defaultHeaders.contentType);for(n in r)r.hasOwnProperty(n)&&"setRequestHeader"in e&&e.setRequestHeader(n,r[n])}function setCredentials(e,t){"undefined"!=typeof t.withCredentials&&"undefined"!=typeof e.withCredentials&&(e.withCredentials=!!t.withCredentials)}function generalCallback(e){lastValue=e}function urlappend(e,t){return e+(/\?/.test(e)?"&":"?")+t}function handleJsonp(e,t,n,r){var s=uniqid++,i=e.jsonpCallback||"callback",o=e.jsonpCallbackName||reqwest.getcallbackPrefix(s),a=new RegExp("((^|\\?|&)"+i+")=([^&]+)"),u=r.match(a),l=doc.createElement("script"),c=0,p=-1!==navigator.userAgent.indexOf("MSIE 10.0");return u?"?"===u[3]?r=r.replace(a,"$1="+o):o=u[3]:r=urlappend(r,i+"="+o),win[o]=generalCallback,l.type="text/javascript",l.src=r,l.async=!0,"undefined"==typeof l.onreadystatechange||p||(l.htmlFor=l.id="_reqwest_"+s),l.onload=l.onreadystatechange=function(){return l[readyState]&&"complete"!==l[readyState]&&"loaded"!==l[readyState]||c?!1:(l.onload=l.onreadystatechange=null,l.onclick&&l.onclick(),t(lastValue),lastValue=void 0,head.removeChild(l),void(c=1))},head.appendChild(l),{abort:function(){l.onload=l.onreadystatechange=null,n({},"Request is aborted: timeout",{}),lastValue=void 0,head.removeChild(l),c=1}}}function getRequest(e,t){var n,r=this.o,s=(r.method||"GET").toUpperCase(),i="string"==typeof r?r:r.url,o=r.processData!==!1&&r.data&&"string"!=typeof r.data?reqwest.toQueryString(r.data):r.data||null,a=!1;return"jsonp"!=r.type&&"GET"!=s||!o||(i=urlappend(i,o),o=null),"jsonp"==r.type?handleJsonp(r,e,t,i):(n=r.xhr&&r.xhr(r)||xhr(r),n.open(s,i,r.async===!1?!1:!0),setHeaders(n,r),setCredentials(n,r),win[xDomainRequest]&&n instanceof win[xDomainRequest]?(n.onload=e,n.onerror=t,n.onprogress=function(){},a=!0):n.onreadystatechange=handleReadyState(this,e,t),r.before&&r.before(n),a?setTimeout(function(){n.send(o)},200):n.send(o),n)}function Reqwest(e,t){this.o=e,this.fn=t,init.apply(this,arguments)}function setType(e){return e.match("json")?"json":e.match("javascript")?"js":e.match("text")?"html":e.match("xml")?"xml":void 0}function init(o,fn){function complete(e){for(o.timeout&&clearTimeout(self.timeout),self.timeout=null;self._completeHandlers.length>0;)self._completeHandlers.shift()(e)}function success(resp){var type=o.type||resp&&setType(resp.getResponseHeader("Content-Type"));resp="jsonp"!==type?self.request:resp;var filteredResponse=globalSetupOptions.dataFilter(resp.responseText,type),r=filteredResponse;try{resp.responseText=r}catch(e){}if(r)switch(type){case"json":try{resp=win.JSON?win.JSON.parse(r):eval("("+r+")")}catch(err){return error(resp,"Could not parse JSON in response",err)}break;case"js":resp=eval(r);break;case"html":resp=r;break;case"xml":resp=resp.responseXML&&resp.responseXML.parseError&&resp.responseXML.parseError.errorCode&&resp.responseXML.parseError.reason?null:resp.responseXML}for(self._responseArgs.resp=resp,self._fulfilled=!0,fn(resp),self._successHandler(resp);self._fulfillmentHandlers.length>0;)resp=self._fulfillmentHandlers.shift()(resp);complete(resp)}function timedOut(){self._timedOut=!0,self.request.abort()}function error(e,t,n){for(e=self.request,self._responseArgs.resp=e,self._responseArgs.msg=t,self._responseArgs.t=n,self._erred=!0;self._errorHandlers.length>0;)self._errorHandlers.shift()(e,t,n);complete(e)}this.url="string"==typeof o?o:o.url,this.timeout=null,this._fulfilled=!1,this._successHandler=function(){},this._fulfillmentHandlers=[],this._errorHandlers=[],this._completeHandlers=[],this._erred=!1,this._responseArgs={};var self=this;fn=fn||function(){},o.timeout&&(this.timeout=setTimeout(function(){timedOut()},o.timeout)),o.success&&(this._successHandler=function(){o.success.apply(o,arguments)}),o.error&&this._errorHandlers.push(function(){o.error.apply(o,arguments)}),o.complete&&this._completeHandlers.push(function(){o.complete.apply(o,arguments)}),this.request=getRequest.call(this,success,error)}function reqwest(e,t){return new Reqwest(e,t)}function normalize(e){return e?e.replace(/\r?\n/g,"\r\n"):""}function serial(e,t){var n,r,s,i,o=e.name,a=e.tagName.toLowerCase(),u=function(e){e&&!e.disabled&&t(o,normalize(e.attributes.value&&e.attributes.value.specified?e.value:e.text))};if(!e.disabled&&o)switch(a){case"input":/reset|button|image|file/i.test(e.type)||(n=/checkbox/i.test(e.type),r=/radio/i.test(e.type),s=e.value,(!(n||r)||e.checked)&&t(o,normalize(n&&""===s?"on":s)));break;case"textarea":t(o,normalize(e.value));break;case"select":if("select-one"===e.type.toLowerCase())u(e.selectedIndex>=0?e.options[e.selectedIndex]:null);else for(i=0;e.length&&i<e.length;i++)e.options[i].selected&&u(e.options[i])}}function eachFormElement(){var e,t,n=this,r=function(e,t){var r,s,i;for(r=0;r<t.length;r++)for(i=e[byTag](t[r]),s=0;s<i.length;s++)serial(i[s],n)};for(t=0;t<arguments.length;t++)e=arguments[t],/input|select|textarea/i.test(e.tagName)&&serial(e,n),r(e,["input","select","textarea"])}function serializeQueryString(){return reqwest.toQueryString(reqwest.serializeArray.apply(null,arguments))}function serializeHash(){var e={};return eachFormElement.apply(function(t,n){t in e?(e[t]&&!isArray(e[t])&&(e[t]=[e[t]]),e[t].push(n)):e[t]=n},arguments),e}function buildParams(e,t,n,r){var s,i,o,a=/\[\]$/;if(isArray(t))for(i=0;t&&i<t.length;i++)o=t[i],n||a.test(e)?r(e,o):buildParams(e+"["+("object"==typeof o?i:"")+"]",o,n,r);else if(t&&"[object Object]"===t.toString())for(s in t)buildParams(e+"["+s+"]",t[s],n,r);else r(e,t)}var win=window,doc=document,httpsRe=/^http/,protocolRe=/(^\w+):\/\//,twoHundo=/^(20\d|1223)$/,byTag="getElementsByTagName",readyState="readyState",contentType="Content-Type",requestedWith="X-Requested-With",head=doc[byTag]("head")[0],uniqid=0,callbackPrefix="reqwest_"+ +new Date,lastValue,xmlHttpRequest="XMLHttpRequest",xDomainRequest="XDomainRequest",noop=function(){},isArray="function"==typeof Array.isArray?Array.isArray:function(e){return e instanceof Array},defaultHeaders={contentType:"application/x-www-form-urlencoded",requestedWith:xmlHttpRequest,accept:{"*":"text/javascript, text/html, application/xml, text/xml, */*",xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript",js:"application/javascript, text/javascript"}},xhr=function(e){if(e.crossOrigin===!0){var t=win[xmlHttpRequest]?new XMLHttpRequest:null;if(t&&"withCredentials"in t)return t;if(win[xDomainRequest])return new XDomainRequest;throw new Error("Browser does not support cross-origin requests")}return win[xmlHttpRequest]?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},globalSetupOptions={dataFilter:function(e){return e}};return Reqwest.prototype={abort:function(){this._aborted=!0,this.request.abort()},retry:function(){init.call(this,this.o,this.fn)},then:function(e,t){return e=e||function(){},t=t||function(){},this._fulfilled?this._responseArgs.resp=e(this._responseArgs.resp):this._erred?t(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):(this._fulfillmentHandlers.push(e),this._errorHandlers.push(t)),this},always:function(e){return this._fulfilled||this._erred?e(this._responseArgs.resp):this._completeHandlers.push(e),this},fail:function(e){return this._erred?e(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):this._errorHandlers.push(e),this},"catch":function(e){return this.fail(e)}},reqwest.serializeArray=function(){var e=[];return eachFormElement.apply(function(t,n){e.push({name:t,value:n})},arguments),e},reqwest.serialize=function(){if(0===arguments.length)return"";var e,t,n=Array.prototype.slice.call(arguments,0);return e=n.pop(),e&&e.nodeType&&n.push(e)&&(e=null),e&&(e=e.type),t="map"==e?serializeHash:"array"==e?reqwest.serializeArray:serializeQueryString,t.apply(null,n)},reqwest.toQueryString=function(e,t){var n,r,s=t||!1,i=[],o=encodeURIComponent,a=function(e,t){t="function"==typeof t?t():null==t?"":t,i[i.length]=o(e)+"="+o(t)};if(isArray(e))for(r=0;e&&r<e.length;r++)a(e[r].name,e[r].value);else for(n in e)e.hasOwnProperty(n)&&buildParams(n,e[n],s,a);return i.join("&").replace(/%20/g,"+")},reqwest.getcallbackPrefix=function(){return callbackPrefix},reqwest.compat=function(e,t){return e&&(e.type&&(e.method=e.type)&&delete e.type,e.dataType&&(e.type=e.dataType),e.jsonpCallback&&(e.jsonpCallbackName=e.jsonpCallback)&&delete e.jsonpCallback,e.jsonp&&(e.jsonpCallback=e.jsonp)),new Reqwest(e,t)},reqwest.ajaxSetup=function(e){e=e||{};for(var t in e)globalSetupOptions[t]=e[t]},reqwest}),function(e,t){var n={version:"2.1.6",areas:{},apis:{},inherit:function(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n]);return t},stringify:function(e){return void 0===e||"function"==typeof e?e+"":JSON.stringify(e)},parse:function(e){try{return JSON.parse(e)}catch(t){return e}},fn:function(e,t){n.storeAPI[e]=t;for(var r in n.apis)n.apis[r][e]=t},get:function(e,t){return e.getItem(t)},set:function(e,t,n){e.setItem(t,n)},remove:function(e,t){e.removeItem(t)},key:function(e,t){return e.key(t)},length:function(e){return e.length},clear:function(e){e.clear()},Store:function(e,t,r){var s=n.inherit(n.storeAPI,function(e,t,n){return 0===arguments.length?s.getAll():void 0!==t?s.set(e,t,n):"string"==typeof e?s.get(e):e?s.setAll(e,t):s.clear()});return s._id=e,s._area=t||n.inherit(n.storageAPI,{items:{},name:"fake"}),s._ns=r||"",n.areas[e]||(n.areas[e]=s._area),n.apis[s._ns+s._id]||(n.apis[s._ns+s._id]=s),s},storeAPI:{area:function(e,t){var r=this[e];return r&&r.area||(r=n.Store(e,t,this._ns),this[e]||(this[e]=r)),r},namespace:function(e,t){if(!e)return this._ns?this._ns.substring(0,this._ns.length-1):"";var r=e,s=this[r];return s&&s.namespace||(s=n.Store(this._id,this._area,this._ns+r+"."),this[r]||(this[r]=s),t||s.area("session",n.areas.session)),s},isFake:function(){return"fake"===this._area.name},toString:function(){return"store"+(this._ns?"."+this.namespace():"")+"["+this._id+"]"},has:function(e){return this._area.has?this._area.has(this._in(e)):!!(this._in(e)in this._area)},size:function(){return this.keys().length},each:function(e,t){for(var r=0,s=n.length(this._area);s>r;r++){var i=this._out(n.key(this._area,r));if(void 0!==i&&e.call(this,i,t||this.get(i))===!1)break;s>n.length(this._area)&&(s--,r--)}return t||this},keys:function(){return this.each(function(e,t){t.push(e)},[])},get:function(e,t){var r=n.get(this._area,this._in(e));return null!==r?n.parse(r):t||r},getAll:function(){return this.each(function(e,t){t[e]=this.get(e)},{})},set:function(e,t,r){var s=this.get(e);return null!=s&&r===!1?t:n.set(this._area,this._in(e),n.stringify(t),r)||s},setAll:function(e,t){var n,r;for(var s in e)r=e[s],this.set(s,r,t)!==r&&(n=!0);return n},remove:function(e){var t=this.get(e);return n.remove(this._area,this._in(e)),t},clear:function(){return this._ns?this.each(function(e){n.remove(this._area,this._in(e))},1):n.clear(this._area),this},clearAll:function(){var e=this._area;for(var t in n.areas)n.areas.hasOwnProperty(t)&&(this._area=n.areas[t],this.clear());return this._area=e,this},_in:function(e){return"string"!=typeof e&&(e=n.stringify(e)),this._ns?this._ns+e:e},_out:function(e){return this._ns?e&&0===e.indexOf(this._ns)?e.substring(this._ns.length):void 0:e}},storageAPI:{length:0,has:function(e){return this.items.hasOwnProperty(e)},key:function(e){var t=0;for(var n in this.items)if(this.has(n)&&e===t++)return n},setItem:function(e,t){this.has(e)||this.length++,this.items[e]=t},removeItem:function(e){this.has(e)&&(delete this.items[e],this.length--)},getItem:function(e){return this.has(e)?this.items[e]:null},clear:function(){for(var e in this.list)this.removeItem(e)},toString:function(){return this.length+" items in "+this.name+"Storage"}}};e.store&&(n.conflict=e.store);var r=n.Store("local",function(){try{return localStorage}catch(e){}}());r.local=r,r._=n,r.area("session",function(){try{return sessionStorage}catch(e){}}()),"function"==typeof t&&void 0!==t.amd?t(function(){return r}):"undefined"!=typeof module&&module.exports?module.exports=r:e.store=r}(window,window.define),function(e){function t(e){if(!s(e))return e;for(var t,n,r=1,i=arguments.length;i>r;r++){t=arguments[r];for(n in t)e[n]=t[n]}return e}function n(e){return"[object Array]"===Object.prototype.toString.call(e)}function r(e){return""+typeof e=="function"}function s(e){var t=typeof e;return"function"===t||"object"===t&&!!e}function i(e){return"string"==typeof e||e&&"object"==typeof e&&"[object String]"==Object.prototype.toString.call(e)||!1}function o(){var e=performance.now(),t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)});return t}function a(e){if(y=t({},v,e),i(y.transport))y.transport=[y.transport];else if(!n(y.transport))throw"Gumeshoe: Transport property must be a [String] or [Array].";_("uuid")||_("uuid",o()),g.__internal__.config=y}function u(e,t,n){if(null!==e)if(Array.prototype.forEach&&e.forEach===Array.prototype.forEach)e.forEach(t,n);else if(e.length===+e.length){for(var r=0,s=e.length;s>r;r++)if(t.call(n,e[r],r,e)==={})return}else for(var i in e)if(e.hasOwnProperty(i)&&t.call(n,e[i],i,e)==={})return}function l(e,t,n){var r=[];return e?Array.prototype.map&&e.map===Array.prototype.map?e.map(t,n):(u(e,function(e,s,i){r[r.length]=t.call(n,e,s,i)}),r):r}function c(){var e,t=navigator.plugins||[];return e=l(t,function(e){var t=l(e,function(e){var t=e.type;return e.suffixes&&(t+="~"+e.suffixes),t});return{description:e.description,filename:e.filename,mimeTypes:t,name:e.name}})}function p(){var e,t,n={characterSet:document.characterSet||document.charset||document.inputEncoding||"Unknown",colorDepth:screen.colorDepth+"",cookie:document.cookie,googleClickId:A.gclid||"",hash:window.location.hash,host:window.location.host,hostName:window.location.hostname,ipAddress:"",javaEnabled:navigator.javaEnabled(),language:document.documentElement?document.documentElement.lang:window.navigator.language||"Unknown",loginKey:A.lk||"",origin:window.location.origin,path:window.location.pathname,platform:window.navigator.platform,plugins:c(),port:window.location.port||80,promotionKey:A.pkey||"",protocol:window.location.protocol,queryString:window.location.search,referer:document.referrer,screenAvailHeight:screen.availHeight,screenAvailWidth:screen.availWidth,screenHeight:screen.height,screenOrientationAngle:"",screenOrientationType:"",screenPixelDepth:screen.pixelDepth+"",screenResolution:screen.width+"x"+screen.height,screenWidth:screen.width,title:document.title,url:window.location.href,userAgent:window.navigator.userAgent,utmCampaign:A.utm_campaign||"",utmContent:A.utm_content||"",utmMedium:A.utm_medium||"",utmSource:A.utm_source||"",utmTerm:A.utm_term||"",viewportHeight:b.height,viewportResolution:b.width+"x"+b.height,viewportWidth:b.width},r=["port","screenAvailHeight","screenAvailWidth","screenHeight","screenOrientationAngle","screenWidth","viewportHeight","viewportWidth"];screen.orientation&&(n.screenOrientationAngle=parseInt(screen.orientation.angle?screen.orientation.angle:"0"),n.screenOrientationType=screen.orientation.type?screen.orientation.type:"",isNaN(n.screenOrientationAngle)&&(n.screenOrientationAngle=0));for(var s=0;s<r.length;s++)e=r[s],t=parseInt(n[e]),isNaN(t)&&(t=0),n[e]=t;return n}function f(e,n){for(var r=p(),s={eventName:e,eventData:n||{},pageData:r,sessionUuid:_("uuid"),timestamp:(new Date).getTime(),timezoneOffset:(new Date).getTimezoneOffset(),uuid:o()},a=!1,u=0;u<y.transport.length;u++){var l,c,f=y.transport[u];if(!f||!q[f])throw"Gumshoe: The transport name: "+f+", doesn't map to a valid transport.";a=!0,l=q[f],c=l.map?l.map(s):s,c=t(s,c),i(c.eventData)||(c.eventData=JSON.stringify(c.eventData)),d(e,f,c)}if(!a)throw"Gumshoe: No valid transports were found."}function h(){if(x.length){var e=x.shift(),t=q[e.transportName];t.send(e.data),_("queue",x),setTimeout(h,y.queueTimeout)}}function d(e,t,n){x.push({eventName:e,transportName:t,data:n}),_("queue",x),setTimeout(h,y.queueTimeout)}function m(e){if(!e.name)throw"Gumshoe: Transport [Object] must have a name defined.";q[e.name]=e}var g,y,w=e.store,v={transport:"",queueTimeout:100},_=w.namespace("gumshoe").session,x=_("queue")||[],q={},A=queryString.parse(location.search),b=function(){var e=window,t="inner";return"innerWidth"in window||(t="client",e=document.documentElement||document.body),{width:e[t+"Width"],height:e[t+"Height"]}}();if(g=t(a,{version:"0.4.0",extend:t,send:f,transport:m,uuid:o,__internal__:{collect:p,config:y,queue:x,storage:_,transports:q}}),e.gumshoe){if(e.gumshoe=t(e.gumshoe,g),e.gumshoe.ready){if(!r(e.gumshoe.ready.resolve))throw"Gumshoe: gumshoe.ready was predefined, but is not a Promise/A deferred.";e.gumshoe.ready.resolve()}}else e.gumshoe=g}(this);